function dtScreens_Selector(e){var t=[];e.length>0?t=e:t.push(e);var i={CUTOKEN_REQUEST:$("#cu-token").val(),op:"save",images:t,item:$("#item-id").val()};$.post("screens.php",i,function(e){if(cuHandler.retrieveAjax(e),void 0==e.images||e.images.length<=0)return!1;for(var t='<tr data-id="%image-id%"><td class="text-center"><input type="checkbox" name="ids[]" value="%image-id%" data-oncheck="screens"></td><td class="text-center"><strong>%image-id%</strong></td><td class="text-center"><a href="%image-url%" target="_blank"><img src="%image-th%"></a></td><td class="the-title"><strong>%image-title%</strong></td><td class="the-desc">%image-desc%</td><td class="cu-options"><a href="#" class="edit-screen warning">'+jsLang.edit+'</a> <a href="#" class="delete-screen danger">'+jsLang["delete"]+"</a></td></tr>",i=$("#table-screens > tbody"),a=e.images,s=0;s<a.length;s++)$(i).append(t.replace(/\%image-id\%/g,a[s].id).replace("%image-url%",a[s].link).replace("%image-th%",a[s].thumbnail).replace("%image-title%",a[s].title).replace("%image-desc%",a[s].description))},"json")}$(document).ready(function(){$("#screens-selector").click(function(){cuHandler.imagesManager({idContainer:"dt-screenshots",type:"external",target:"dtScreens_Selector",multiple:"yes",title:jsLang.insertScreen})}),$("#table-screens").on("click","a.edit-screen",function(){$(this).cuSpinner(),$("#editor").slideUp("fast",function(){$("tr[data-id='"+$(this).find("#scr-id").val()+"']").slideDown("fast"),$(this).remove()});var e=$(this).parents("tr"),t=$(this).parents("tr").data("id"),i={op:"image-info",CUTOKEN_REQUEST:$("#cu-token").val(),id:t},a=$(this);return $.get("screens.php",i,function(t){if($(a).cuSpinner(),0==cuHandler.retrieveAjax(t))return!1;var i='<tr id="editor" style="display: none;">';i+='<td colspan="3" align="center"><img src="'+$(e).find("img").attr("src")+'" style="width: auto; height: auto;" /></td>',i+='<td colspan="3"><div class="dt_table"><div class="dt_row">',i+='<div class="dt_cell"><strong>'+jsLang.titleField+"</strong></div>",i+='<div class="dt_cell"><input type="text" name="title" id="the-title" value="'+t.title+'" class="form-control"></div></div>',i+='<div class="dt_row">',i+='<div class="dt_cell"><strong>'+jsLang.descField+"</strong></div>",i+='<div class="dt_cell"><textarea name="desc" id="the-desc" rows="4" class="form-control">'+t.description+"</textarea></div></div>",i+='<div class="dt_row">',i+='<div class="dt_cell">&nbsp;</div>',i+='<div class="dt_cell"><button type="button" class="btn btn-primary" id="save-data">'+jsLang.saveData+"</button>",i+=' <button type="button" id="cancel-save" class="btn btn-default">'+jsLang.cancel+'</button><input type="hidden" name="id" id="scr-id" value="'+t.id+'" /></div></div>',i+="</div></td></tr>",$(e).after(i),$(e).fadeOut(function(){$("#editor").fadeIn()})},"json"),!1}),$("#table-screens").on("click","a.delete-screen",function(){var e=$(this).parents("tr");$(e).find("input:checkbox").prop("checked",!0),$("#bulk-top").val("delete-screen"),$("#frm-screens").submit()}),$("#frm-screens").submit(function(){if(""==$("#bulk-top").val())return!1;if($(this).find("input:checked").length<=0)return cuHandler.notify({text:jsLang.noCheckedScreen,type:"alert-danger",icon:"svg-rmcommon-error"}),!1;if("delete-screen"==$("#bulk-top").val()&&0==confirm(jsLang.deleteScreen))return!1;var e=$("#frm-screens").serialize();return e+="&CUTOKEN_REQUEST="+$("#cu-token").val(),$.post("screens.php",e,function(e){if(0==cuHandler.retrieveAjax(e))return!1;for(var t=e.images,i=0;i<t.length;i++)$("tr[data-id='"+t[i]+"']").fadeOut(function(){$(this).remove()})},"json"),!1}),$("#table-screens").on("click","#cancel-save",function(){$("#editor").hide(function(){$("tr[data-id='"+$(this).find("#scr-id").val()+"']").fadeIn(),$(this).remove()})}),$("#table-screens").on("click","#save-data",function(){if(""==$("#the-title").val())return void alert(jsLang.noTitle);var e={title:$("#the-title").val(),desc:$("#the-desc").val(),id:$("#scr-id").val(),CUTOKEN_REQUEST:$("#cu-token").val(),op:"save-screen-data"};$.post("screens.php",e,function(e){if(0==cuHandler.retrieveAjax(e))return!1;var t="<strong>"+e.title+"</strong>";$("tr[data-id='"+e.id+"'] td.the-title").html(t),$("tr[data-id='"+e.id+"'] td.the-desc").html(e.description),$("#editor").fadeOut(function(){$("tr[data-id='"+$(this).find("#scr-id").val()+"']").fadeIn(),$(this).remove()})},"json")})});
