function dt_check_delete(e,t){if(e<=0)return!1;$("#"+t+" input[type=checkbox]").removeAttr("checked"),$("#item-"+e).prop("checked","checked"),$("#bulk-top").val("delete"),before_submit(t)}function before_submit(e){return""!=$("#bulk-top").val()&&($("#"+e+" tbody input:checked").length<=0?(cuHandler.notify({text:jsLang.noSelectMsg,type:"alert-warning",icon:"svg-rmcommon-alert"}),!1):void("delete"==$("#bulk-top").val()?confirm(jsLang.confirmDeletion)&&$("#"+e).submit():$("#"+e).submit()))}function block_screen(e,t){1==e?($("body").append("<div id='items-blocker'></div>"),$("#items-blocker").fadeIn("fast")):$("#items-blocker").slideUp("fast",function(){$("#status-bar").slideUp("fast",function(){$("#status-bar").css("background",t),$("#items-blocker").remove()})})}function dt_show_error(e){cuHandler.notify({text:e.message,type:"alert-danger",icon:"svg-rmcommon-error"}),""==e.token&&window.location.reload(),$("#XOOPS_TOKEN_REQUEST").val(e.token)}!function(e){var t;e(document).ready(function(){e("body").on("shown.bs.modal","#modal-features",function(){setTimeout(function(){"undefined"!=typeof mdEditor?mdEditor.init("content"):"undefined"!=typeof tinyMCE?(tinymce.get("content")&&tinymce.get("content").destroy(),t=initMCE("#content"),edToolbar("content")):"undefined"!=typeof edToolbar&&edToolbar("content")},500)}),e("#add-feature").click(function(){var t={CUTOKEN_REQUEST:e("#cu-token").val(),item:e("#item-id").val(),action:"new"};return e.get("features.php",t,function(e){if(0==cuHandler.retrieveAjax(e))return!1},"json"),!1}),e("body").on("submit","#frm-features",function(){var t=e(this).serialize();return t+="&CUTOKEN_REQUEST="+e("#cu-token").val(),e.post(e(this).attr("action"),t,function(t){if(0==cuHandler.retrieveAjax(t))return!1;var a=e("#table-features tr[data-id='"+t.feature.id+"']");if(a.length>0)e(a).find("td.name").html("<strong>"+t.feature.title+"</strong>"),e(a).find("td.modified").html(t.feature.modified);else{var n=e("#table-features > tbody"),i='<tr data-id="'+t.feature.id+'"><td class="text-center"><input type="checkbox" name="ids[]" value="'+t.feature.id+'" data-oncheck="features"></td><td class="text-center" width="20"><strong>'+t.feature.id+'</strong></td><td class="name"><strong>'+t.feature.title+'</strong></td><td class="text-center">'+t.feature.created+'</td><td class="text-center modified">'+t.feature.modified+'</td><td class="text-center cu-options"><a href="#" data-id="'+t.feature.id+'" class="warning">'+jsLang.edit+'</a> <a href="#" data-id="'+t.feature.id+'" class="danger">'+jsLang.delete+"</a></td></tr>";e(n).append(i),e("html, body").stop().animate({scrollTop:e("#table-features tr[data-id='"+t.feature.id+"']").offset().top},900,"swing")}},"json"),!1}),e("body").on("click","#table-features .cu-options .edit",function(){var t={id:e(this).parents("tr").data("id"),CUTOKEN_REQUEST:e("#cu-token").val(),item:e("#item-id").val(),action:"edit"};e.get("features.php",t,function(e){if(0==cuHandler.retrieveAjax(e))return!1;"undefined"!=typeof mdEditor?mdEditor.init("content"):"undefined"!=typeof tinyMCE?(initMCE("content"),edToolbar("content")):"undefined"!=typeof edToolbar&&edToolbar("content")},"json")}),e("body").on("click","#table-features .cu-options .delete",function(){e("#table-features :checkbox").prop("checked",!1),e(this).parents("tr").find(":checkbox").prop("checked",!0),e("#bulk-top, #bulk-bottom").val("delete"),e("#frm-feats").submit()}),e("#frm-feats").submit(function(){if(e(this).find("tbody :checkbox:checked").length<=0)return cuHandler.notify({text:jsLang.noSelectFeature,type:"alert-warning",icon:"svg-rmcommon-alert"}),!1;if(0==confirm(jsLang.confirmFeatureDeletion))return!1;var t=e(this).serialize();return t+="&CUTOKEN_REQUEST="+e("#cu-token").val()+"&action=delete",e.post("features.php",t,function(t){cuHandler.retrieveAjax(t);for(var a=0;a<t.ids.length;a++)e("#table-features tr[data-id='"+t.ids[a]+"']").fadeOut(function(){e(this).remove()});e("#bulk-top, #bulk-bottom").val(""),e("#table-features :checkbox:checked").prop("checked",!1)},"json"),!1})})}(jQuery),function(e){var t;e(document).ready(function(){if(e("#dtfiles-uploader").length>0){var a=!1;Dropzone.options.dtfilesUploader=!1,(t=new Dropzone("#dtfiles-uploader",{url:xoUrl+"/modules/dtransport/ajax/upload.php",acceptedFiles:dtExts,maxFileSize:dtSize,parallelUpload:1,autoProcessQueue:!0,maxFiles:1,params:{CUTOKEN_REQUEST:e("#cu-token").val(),item:e("#item").val()},dictDefaultMessage:cuLanguage.dzDefault,init:function(){this.on("success",function(t,n){if(a=!1,n=JSON.parse(n),0==cuHandler.retrieveAjax(n))return!1;e("#dtfiles-preview > .name").html(n.file),e("#dtfiles-preview > .size").html(n.size),e("#size").val(n.fullsize),e("#dtfiles-preview .type").html(n.mime),e("#dtfiles-preview .secure").html(n.secure)}),this.on("queuecomplete",function(){0==a&&(e("#dtfiles-preview").fadeIn(),e("#dtfiles-uploader").fadeOut())}),this.on("error",function(){a=!0})}})).on("complete",function(e){t.removeFile(e)})}e("#create-group").click(function(){if(""==e("#group-name").val())return cuHandler.notify({text:jsLang.groupName,type:"alert-warning",icon:"svg-rmcommon-alert"}),e("#group-name").focus(),!1;var t=e("#form-new-group").serialize();t+="&XOOPS_TOKEN_REQUEST="+e("#XOOPS_TOKEN_REQUEST").val(),block_screen(1),e("#status-bar").slideDown("fast"),e.post("../ajax/files-ajax.php",t,function(t){if(1==t.error)return alert(t.message),""==t.token&&window.location.reload(),e("#XOOPS_TOKEN_REQUEST").val(t.token),block_screen(0),e("#status-bar").slideUp("fast"),void e("#group-name").focus();if(block_screen(0),e("#status-bar").slideUp("fast"),e("#XOOPS_TOKEN_REQUEST").val(t.token),"create"==t.action){var a='<tr class="head" id="group-'+t.id+'">';a+='<td colspan="6"><strong>'+t.name+"</strong></td>",a+='<td class="cu-options text-center"><a href="files.php?item='+t.item+"&amp;edit=1&amp;id="+t.id+'" class="editgroup warning">'+jsLang.edit+"</a> ",a+='<a href="files.php?item='+t.item+"&amp;id="+t.id+'&amp;action=deletegroup" class="deletegroup danger">'+jsLang.delete+"</a></td></tr>",e("#table-files tbody").append(a),e("#group-name").val("")}else e("#group-"+t.id+" td:first-child").html(t.name),e("#group-name").val(""),e("#cancel-edition").remove(),e("input#id").remove(),e("#create-group").val(jsLang.createGroup).removeClass("buttonGreen").addClass("buttonBlue"),e("#form-new-group input[name=action]").val("save-group");e("#group-"+t.id).effect("highlight",{},1e3)},"json")}),e("#remote").change(function(){e(this).is(":checked")?(e(".url-container").slideDown("fast",function(){e(this).find("input").effect("highlight",{},1e3)}),e("#dtfiles-uploader").fadeOut("fast"),e("#dtfiles-preview").addClass("transparent")):(e(".url-container").slideUp("fast"),e("#dtfiles-preview").removeClass("transparent"),e("#dtfiles-preview").is(":visible")||e("#dtfiles-uploader").fadeIn("fast"))}),e("#dtfiles-preview .delete").click(function(){if(!confirm(jsLang.deleteFile))return!1;var a={file:e("#dtfiles-preview .name").html(),secure:e("#secure").val(),action:"delete_hfile",CUTOKEN_REQUEST:e("#cu-token").val()};block_screen(1),e("#status-bar").slideDown("fast"),e.post("../ajax/files-ajax.php",a,function(a){if(block_screen(0),0==cuHandler.retrieveAjax(a))return e("#status-bar").slideUp("fast"),!1;t.options.params.CUTOKEN_REQUEST=e("#cu-token").val(),e("#dtfiles-preview").fadeOut("fast",function(){e("#dtfiles-uploader").fadeIn("fast")}),e("#status-bar").slideUp("fast")},"json")}),e("#save-data").click(function(){if(e("#remote").is(":checked")){if(""==e("#url").val())return cuHandler.notify({text:jsLang.noURL,type:"text-danger",icon:"svg-rmcommon-error"}),e("#url").focus(),!1}else if(""==e("#dtfiles-preview span.name").html())return cuHandler.notify({text:jsLang.noFile,type:"text-danger",icon:"svg-rmcommon-error"}),!1;""==e("#title").val()&&(cuHandler.notify({text:jsLang.noTitle,type:"text-danger",icon:"svg-rmcommon-error"}),e("#title").focus());var t={remote:e("#remote").is(":checked")?1:0,title:e("#title").val(),group:e("#group").val(),default:e("#default").is(":checked")?1:0,file:e("#remote").is(":checked")?e("#url").val():e("#dtfiles-preview .name").html(),action:e("#action").val(),id:e("#id").length>0?e("#id").val():0,CUTOKEN_REQUEST:e("#cu-token").val(),item:e("#item").val(),secure:e("#secure").val(),mime:e("#dtfiles-preview span.type").html(),size:e("#size").val()};return block_screen(1),e("#status-bar").slideDown("fast"),e.post("../ajax/files-ajax.php",t,function(t){if(block_screen(0),0==cuHandler.retrieveAjax(t))return e("#status-bar").slideUp("fast"),!1;window.location.href="files.php?item="+e("#item").val()},"json"),!0}),e("#table-files").on("click","a.deletegroup",function(){if(!confirm(jsLang.confirmDeletion))return!1;var t=e(this).attr("href")+"&XOOPS_TOKEN_REQUEST="+e("#XOOPS_TOKEN_REQUEST").val();return window.location.href=t,!1}),e("#table-files").on("click","a.editgroup",function(){var t=e(this).parent().parent().attr("id").replace("group-",""),a=e("#group-"+t+" td:first-child > strong").html();return e("#group-name").val(a),e("#form-new-group").append("<input type='hidden' value='"+t+"' id='id' name='id' />"),e("#cancel-edition").length<=0&&e("#create-group").after(' <button type="button" name="cancel" id="cancel-edition" class="btn btn-default">'+jsLang.cancel+"</button>"),e("#form-new-group input[name=action]").val("update-group"),e(".dt_group_form").effect("hightlight",{},1e3),e("#group-name").focus(),e("#cancel-edition").click(function(){return e("#group-name").val(""),e("input#id").remove(),e("#create-group").val(jsLang.createGroup).removeClass("buttonGreen").addClass("buttonBlue"),e("#form-new-group input[name=action]").val("save-group"),e(this).remove(),!0}),!1}),e("#table-files").on("change","select.group-selector",function(){var t=e(this).parent().parent(),a=e(this).val();block_screen(1),e("#status-bar").slideDown("fast");var n=e("#status-bar").css("background"),i={action:"reasign-file",idgroup:a,id:t.find("input[type='checkbox']").attr("id").replace("item-",""),item:e("#item").val(),XOOPS_TOKEN_REQUEST:e("#XOOPS_TOKEN_REQUEST").val()};a>0&&e("#group-"+a).length<=0||e.post("../ajax/files-ajax.php",i,function(i){1!=i.error?(e("#XOOPS_TOKEN_REQUEST").val(i.token),e("#status-bar").html(i.message),e("#status-bar").css("background","#389931"),block_screen(0,n),e(t).fadeOut("fast",function(){var n=t.clone();if(a<=0)t.remove(),e("#table-files tbody").prepend(n);else{if(e("#group-"+a).length<=0)return void t.fadeIn("fast");t.remove(),e("#group-"+a).after(n)}n.fadeIn("fast"),n.find("select").val(a)})):dt_show_error(i)},"json")}),e("#table-files").on("click","a.delete-file",function(){if(!confirm(jsLang.confirmDeletion))return!1;var t=e(this).parent().parent(),a={id:t.find("input[type='checkbox']").attr("id").replace("item-",""),item:e("#item").val(),XOOPS_TOKEN_REQUEST:e("#XOOPS_TOKEN_REQUEST").val(),action:"delete-file"};block_screen(1),e("#status-bar").slideDown("fast");var n=e("#status-bar").css("background");return e.post("../ajax/files-ajax.php",a,function(a){1!=a.error?(e("#XOOPS_TOKEN_REQUEST").val(a.token),e("#status-bar").html(a.message),e("#status-bar").css("background","#389931"),setTimeout(function(){block_screen(0,n)},3e3),t.fadeOut("fast",function(){t.remove()})):dt_show_error(a)}),!1})})}(jQuery),function(e){this.LicenseApp=function(){var t=this;this.checkEmail=function(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)},this.init=function(){e("#dt-license-form .btn-submit").click(function(){if(0==t.verifyForm())return!1;t.requestLicense()}),e("#form-email, #form-api").keyup(function(){""!=e(this).val()&&e(this).removeClass("has-error").find("+ .error").hide()})},this.verifyForm=function(){var a=e("#form-email"),n=e("#form-api"),i=e("#form-key");return""==e(a).val()?(e(a).addClass("has-error").find("+ .error").fadeIn(),!1):0==t.checkEmail(e(a).val())?(e(a).addClass("has-error").find("+ .error").fadeIn(),!1):""==e(n).val()||40!=e(n).val().length?(e(n).addClass("has-error").find("+ .error").fadeIn(),!1):""==e(i).val()||35!=e(i).val().length?(e(i).addClass("has-error").find("+ .error").fadeIn(),!1):void 0},this.requestLicense=function(){var t=e("#form-email"),a=e("#form-api"),n=e("#form-key"),i={api:e(a).val(),email:e(t).val(),key:e(n).val(),CUTOKEN_REQUEST:e("#cu-token").val()};e.post("register.php",i,function(t){if(0==cuHandler.retrieveAjax(t))return!1;var a='<div id="dt-license-info"><h4 class="title">'+jsLang.nowActive+'</h4><div class="content"><div class="info">'+jsLang.activationInfo+'</div><div class="form-group"><label>'+jsLang.email+'</label><span class="form-control input-lg">%email</span></div><div class="form-group"><label>'+jsLang.serial+'</label><span class="form-control input-lg">%serial</span></div><div class="form-group"><label>'+jsLang.activationDate+'</label><span class="form-control input-lg">%date</span></div><div class="notice">'+jsLang.saveInfo+'</div><div class="form-group"><button type="button" class="btn btn-green btn-lg btn-block" onclick="window.location.reload(true);">'+jsLang.reloadNow+"</button></div></div></div>";e("#dt-license-form").fadeOut(500,function(){e(this).remove(),a=a.replace("%email",t.email).replace("%serial",t.chain).replace("%date",t.date),e("#dt-license-cover").append(a),e("#dt-license-info").fadeIn("500")})},"json")}},e(document).ready(function(){(new LicenseApp).init()})}(jQuery),$(document).ready(function(){$("#bulk-top").change(function(){$("#bulk-bottom").val($(this).val())}),$("#bulk-bottom").change(function(){$("#bulk-top").val($(this).val())}),$("#frm-add").length>0&&$("#frm-add").validate()});